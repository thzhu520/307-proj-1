<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Submit a Report</title>
    <link rel="stylesheet" href="adminall-issues.css">
    <link href="https://fonts.googleapis.com/css2?family=Playpen+Sans:wght@400;700&display=swap" rel="stylesheet">
</head>

<body>
    <!-- Navbar -->
    <header class="navbar">
        <div class="navbar-logo">
            <a href="issue_admin.html">
                <img src="../icon.png" alt="SLOutions Logo">
            </a>
        </div>
        <nav class="navbar-links">
            <a href="adminabout.html">About Us</a>
            <a href="adminall-issues.html">All Issues</a>
            <a href="adminsubmit-report.html">Submit a Report</a>
            <a href="adminfaq.html">FAQ</a>
        </nav>
        <div class="static-bar">
            <a href="issuemain_admin.html">
                <img src="../staticbar.png" alt="Home Icon" class="static-bar-icon">
            </a>
        </div>
    </header>

    <!-- Main Content -->
    <div class="main-content">
        <h1 class="form-title">All Issues</h1>
        <div class="content-container">
            <!-- Dynamically loaded content will appear here -->
        </div>
    </div>

        <script>
        async function fetchReports() {
    try {
        // Retrieve the token from local storage
        const token = localStorage.getItem('token'); // Ensure the key is correct

        if (!token) {
            console.error('No token found in local storage');
            return;
        }

        // Make the request with the token
        const response = await fetch('https://sloutions-cugpega6c5efaba4.westus3-01.azurewebsites.net/api/reports', {
            headers: {
                'Authorization': `Bearer ${token}`, // Correctly include the token
                'Content-Type': 'application/json', // Proper header for JSON
            },
        });

        if (!response.ok) {
            throw new Error(`Failed to fetch reports: ${response.status} ${response.statusText}`);
        }

        const data = await response.json();

        // Display reports in the frontend
        const contentContainer = document.querySelector('.content-container');
        contentContainer.innerHTML = ''; // Clear existing content

        data.reports.forEach(report => {
            const reportCard = document.createElement('div');
            reportCard.classList.add('issue-card');
            reportCard.innerHTML = `
                <p><strong>Title:</strong> ${report.title}</p>
                <p><strong>Location:</strong> ${report.location}</p>
                <p><strong>Description:</strong> ${report.description}</p>
                <p><strong>Date:</strong> ${new Date(report.createdDate).toLocaleString()}</p>
                <p><strong>Status:</strong> ${report.status}</p>
            `;
            contentContainer.appendChild(reportCard);
        });
    } catch (error) {
        console.error('Error fetching reports:', error);
        const contentContainer = document.querySelector('.content-container');
        contentContainer.innerHTML = '<p>Error loading reports. Please try again later.</p>';
    }
}


            </script>
            
    </body>

    </html>
